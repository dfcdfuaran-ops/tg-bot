# 🤖 TG-SELL-BOT
<sub>Telegram бот для управления подписками и продажи доступа к панели Remnawave.<br>
Проект создан на основе популярного бота **Remnashop** с улучшениями и адаптацией.</sub>

___

## 🎯 Основные возможности

> 🛍️ Управление тарифными планами и подписками<br>
> 💳 Интеграция с платежными системами (Yookassa, Cryptomus, Telegram Stars и др.)<br>
> 📊 Полная система аналитики и статистики<br>
> 🎟️ Система промокодов и реферралов<br>
> 👥 Управление пользователями и доступом<br>
> 📢 Рассылки и уведомления<br>
> ⚙️ Простое управление через встроенный админ-интерфейс<br>

___

## 📋 Требования

### 🖥️ Система
- Ubuntu **20.04 / 22.04 / 24.04** или другой Linux
- Доступ **root** или возможность использовать `sudo`

### 📦 Установленные пакеты
- **Docker** (версия 20.10+)
- **Docker Compose** (версия 2.0+)
- **curl** и **wget**
- **remnawave** (версия 2.4+)

<sub>⚠️ Все пакеты устанавливаются при автоматической установке.<br>
⚠️ При ручной установке необходимо проверить наличие.</sub>

### 🔐 Telegram
- Токен бота от **[@BotFather](https://t.me/BotFather)**
- Ваш Telegram ID (получить у **[@userinfobot](https://t.me/userinfobot)**)
- Username для поддержки (ваш аккаунт или группа)

<sub>⚠️ Обязательно используйте защищённые токены и ключи.</sub>

### 🔗 API
- Токен Remnawave (Remnawave → Настройки Remnawave → API Токены)
- Домен для публичного доступа к боту

___

## 🚀 Быстрая установка

### ▶️ Полная установка в один шаг
```bash
git clone -b main --depth 1 https://github.com/dfcdfuaran-ops/tg-bot.git tg-sell-bot > /dev/null 2>&1 && cd tg-sell-bot && ./install.sh && cd /opt && rm -rf tg-sell-bot/.git
```

### ▶️ Пошаговая установка
```bash
git clone -b main https://github.com/dfcdfuaran-ops/tg-bot.git tg-sell-bot
cd tg-sell-bot
./install.sh
```

### 📦 Что делает скрипт установки
- Установит Docker и Docker Compose (если необходимо)
- Клонирует репозиторий в `/opt/tg-sell-bot`
- Создаст файл конфигурации `.env` с защищёнными ключами
- Запросит обязательные параметры
- Соберёт Docker образ
- Запустит все сервисы (БД, Redis, Бот, Worker, Scheduler)
- Автоматически определит и настроит реверс-прокси (Caddy/Nginx) если установлен

<sub>⏱️ Среднее время установки: 1-2 минуты.</sub>

___

## 🛠 Управление ботом

### 🌍 Глобальная команда управления
После установки бота, управляйте им из любой директории:
```bash
tg-sell-bot
```

### 📋 Интерактивное меню

Скрипт `install.sh` объединяет функции установки и управления в единый интерактивный интерфейс с клавишами навигации (↑↓ Enter).

#### Если бот НЕ установлен
```
════════════════════════════════════════
   🚀 TG-SELL-BOT INSTALLER
════════════════════════════════════════

❌ Статус: Не установлен

Доступное действие:
1) Установить
0) Выход
```

#### Если бот УЖЕ установлен
```
════════════════════════════════════════
   🚀 TG-SELL-BOT MANAGEMENT PANEL
════════════════════════════════════════

  🔄  Переустановить
  📦  Проверить обновления
----------------------------------
  ⚙️   Изменить настройки
  🧹  Очистить данные
  🗑️   Удалить бота
----------------------------------
  ❌  Выход

════════════════════════════════════════
Используйте ↑↓ для навигации, Enter для выбора
```

#### Функции меню
1. **🔄 Переустановить** - переустановить бот с потерей данных (требует подтверждения)
2. **📦 Проверить обновления** - загрузить последние изменения с GitHub и перезапустить сервисы
3. **⚙️ Изменить настройки** - изменить домен, токены бота, ID администратора
4. **🧹 Очистить данные** - удалить всех пользователей и кеш базы данных
5. **🗑️ Удалить бота** - полностью удалить бота и все данные (требует двойного подтверждения)

### 📝 Ручное использование скрипта
```bash
cd /opt/tg-bot
./install.sh --install        # Запустить установку
./install.sh                  # Открыть меню управления
```

### 🔧 Docker Compose команды
Для прямого управления без меню:

```bash
# Остановить бота
cd /opt/tg-sell-bot
docker compose down

# Запустить бота
cd /opt/tg-sell-bot
docker compose up -d

# Просмотр логов
cd /opt/tg-sell-bot
docker compose logs -f

# Перезагрузка
cd /opt/tg-sell-bot
docker compose restart

# Удаление контейнеров и volumes
cd /opt/tg-sell-bot
docker compose down -v
```

___

## ⚙️ Обязательные параметры при установке

| Параметр | Описание | Где получить |
|----------|---------|--------------|
| **APP_DOMAIN** | Домен для доступа к боту | Ваш домен (напр: `bot.example.com`) |
| **BOT_TOKEN** | Токен Telegram бота | [@BotFather](https://t.me/BotFather) |
| **BOT_DEV_ID** | Ваш Telegram ID | [@userinfobot](https://t.me/userinfobot) |
| **BOT_SUPPORT_USERNAME** | Username поддержки | Ваш username без `@` |
| **REMNAWAVE_TOKEN** | API токен Remnawave | Панель Remnawave → Settings → API |

<sub>⚠️ Все остальные параметры генерируются автоматически!</sub>

___

## 📖 Администрирование

### Доступ к админ-панели
Админ-панель доступна в приватных сообщениях боту для пользователя с ID равным `BOT_DEV_ID`.

### Основные функции
- ⚙️ Управление тарифами
- 💳 Настройка платежных систем
- 👥 Управление пользователями
- 📊 Статистика и аналитика
- 📢 Рассылки
- 🎟️ Промокоды
- 🔗 Интеграция с Remnawave

___

## 🗑️ Полное удаление бота

```bash
# Переходим в папку проекта
cd /opt/tg-sell-bot

# Останавливаем и удаляем контейнеры, сети, volumes
docker compose down -v

# Удаляем Docker образ
docker rmi tg-sell-bot-remnashop:latest -f 2>/dev/null || true

# Удаляем папку проекта
cd /opt
rm -rf tg-sell-bot
```

<sub>⚠️ Эта операция удалит все данные бота! Сделайте бэкап перед удалением.</sub>

___

## 🆘 Решение проблем

### Проблема: Бот не отвечает

**Решение:**
```bash
# Проверьте логи
docker compose logs remnashop

# Перезагрузите бот
docker compose restart

# Убедитесь что BOT_TOKEN правильный
nano .env

# Убедитесь что в реверс прокси добавлены пути переадресации
nano caddyfile / nano nginx.conf
```

___

## 📚 Дополнительная информация

### История проекта
Проект создан на основе популярного бота **Remnashop** с полной переработкой и адаптацией под платформу Remnawave.

### Лицензия
[Укажите лицензию если нужна]

### Поддержка
Для вопросов и проблем создавайте Issues в репозитории GitHub.
